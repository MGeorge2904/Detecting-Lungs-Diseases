# Detecting-Lungs-Diseases
Репозиторий проекта "Распознавание заболевания лёгких по их рентгенограмме с помощью свёрточной нейронной сети"

В этом проекте рассматриваются две различные архитектуры свёрточных нейронных сетей для распознавания заболеваний лёгких.
Над проектом работал: <br>
<b>Маштаков Георгий Алексеевич</b> <br>
Научный руководитель: <br>
<b>Рубанова Валерия Александровна</b> <br>

#### [Изначальный датасет с сайта kaggle](https://www.kaggle.com/datasets/tawsifurrahman/covid19-radiography-database?resource=download)
В изначальном датасете данные разделены на 4 класса:
1. COVID (COVID-19)
2. Lung_Opacity (Переводится как "Непрозрачность лёгких", но в описании датасета написано, что это Нековидная инфекция)
3. Normal (Здоровые лёгкие)
4. Viral Pneumonia (Вирусная пневмония)

### Описание репозитория:
1. **preprocessing.py** - Подготовка датасета (из изначального датасета)
2. **prepared_dataset** - Подготовленный датасет _(он пока не загружен, но его можно сделать из изначального датасета и **preprocessing.py**)_
3. **Hand-made_CNN.ipynb** - Код с моей нейронной сетью
4. **VGG19+GradCam.ipynb** - Код с нейронной сетью VGG19
5. **model** - Обученная модель
<br>

## Краткое описание всех файлов
### preprocessing.py
В этом файле выполняется случайный выбор 2690 изображений по каждому классу заболеваний. Это сделано для того, чтобы модель равномерно обучилась на всех классах.
Именно 2690, потому что в наименьшем классе 1345 изображений, и изначально планировалась аугментация изображений последнего класса _Viral Pneumonia_(для каждого изображения одно изменение, тем самым количество изображений в этом классе будет 2690), но даже совсем незначительное изменение данных последнего класса понижало точность модели. Поэтому в последней версии аугментации данных нет, но количество изображений для обучения осталось таким же.
### Hand-made_CNN.ipynb
В этом файле сначала выполняется импортирование всех нужных библиотек, затем выполняется считывание и предобработка всех изображений, далле строится базовое решение: Случайные леса дали максимальную точность в 75%, после строится модель свёрточной нейронной сети, состоящей из входного слоя, 5 свёрточных слоёв и MaxPooling, 3 полносвязных слоёв с Dropout(чтобы уменьшить переобучение) и выходного слоя. Дальше выполняется оценка качества обученной модели. В итоге получены Точность в 89% и F1-мера в 90%. <br>
Также получилось сделать GradCAM - способ сегментации изображения, заключающийся в построении карты коэффициентов на последнем свёрточном слое. _Результаты будут расположены в самом конце._
### VGG19+GradCam.ipynb
В этом файле также выполняется предобработка данных, затем инициализируется модель VGG19 без верхних полносвязных слоёв. Затем добавляются 2 полносвязных слоя с Dropout и выходной слой. Другими словами, выполняется Transfer learning, используя Feature extraction. Итоговых результатов пока нет(достигнут уровень предыдущей модели), в связи с ограничением мощностей, но скоро результаты будут улучшены. <br>
В любом случае обучение можно продолжать бесконечно, пока не будет достигнут максимальный или требуемый для нас результат.

&ensp;
## Пример работы GradCAM на каждом классе:
![COVID](https://github.com/MGeorge2904/Detecting-Lungs-Diseases/assets/103932673/3b5d1215-64a0-49e0-a559-05da84df8d33)
![Lung Opacity](https://github.com/MGeorge2904/Detecting-Lungs-Diseases/assets/103932673/5ab73384-c579-4700-8c57-52b8a7c804c8)
<br>
**COVID** &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; **Lung Opacity**
<br> <br>
![Normal](https://github.com/MGeorge2904/Detecting-Lungs-Diseases/assets/103932673/ac6e81f4-4524-403f-8d51-7a26e94f4dd3)
![Viral Pneumonia](https://github.com/MGeorge2904/Detecting-Lungs-Diseases/assets/103932673/0bc9f978-ad4e-4325-a0ef-8e6081c108c9)
<br>
**Normal** &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; **Viral Pneumonia**
